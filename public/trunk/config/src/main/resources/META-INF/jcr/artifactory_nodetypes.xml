<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Artifactory is a binaries repository manager.
  ~ Copyright (C) 2010 JFrog Ltd.
  ~
  ~ Artifactory is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Lesser General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ Artifactory is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Lesser General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Lesser General Public License
  ~ along with Artifactory.  If not, see <http://www.gnu.org/licenses/>.
  -->

<nodeTypes
        xmlns:rep="internal"
        xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
        xmlns:mix="http://www.jcp.org/jcr/mix/1.0"
        xmlns:jcr="http://www.jcp.org/jcr/1.0"
        xmlns:artifactory="http://artifactory.jfrog.org/1.0"
        xmlns:ocm="http://jackrabbit.apache.org/ocm">

    <!-- NOTE: This file requires forward declarations of types
    ATTENTION: All types are minimal declared as they cannot be changed for future version.
    We can however add dynamically and/or on demand mixin to any node.
    So, we declare mixin that we dynamically apply in our code.
    -->

    <nodeType name="artifactory:folder" isMixin="false" hasOrderableChildNodes="false">
        <supertypes>
            <supertype>nt:folder</supertype>
            <supertype>mix:lockable</supertype>
            <supertype>mix:referenceable</supertype>
            <supertype>nt:unstructured</supertype>
        </supertypes>
    </nodeType>

    <!-- file has a primary node of name jcr:content that is of type nt:base,
    which nt:resource is a child of. nt:resource contains all binary data -->
    <nodeType name="artifactory:file" isMixin="false" hasOrderableChildNodes="false">
        <supertypes>
            <supertype>nt:file</supertype>
            <supertype>mix:lockable</supertype>
            <supertype>mix:referenceable</supertype>
            <supertype>nt:unstructured</supertype>
        </supertypes>
    </nodeType>

    <nodeType name="artifactory:metadata" isMixin="false" hasOrderableChildNodes="false">
        <supertypes>
            <supertype>nt:unstructured</supertype>
            <supertype>mix:referenceable</supertype>
            <supertype>nt:unstructured</supertype>
        </supertypes>
    </nodeType>

    <nodeType name="artifactory:base" isMixin="true" hasOrderableChildNodes="false">
        <propertyDefinition name="artifactory:name" requiredType="String" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
        <propertyDefinition name="artifactory:created" requiredType="Date" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
        <propertyDefinition name="artifactory:createdBy" requiredType="String" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
        <propertyDefinition name="artifactory:lastModified" requiredType="Date" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
        <propertyDefinition name="artifactory:lastModifiedBy" requiredType="String" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
        <propertyDefinition name="artifactory:lastUpdated" requiredType="Date" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
    </nodeType>

    <!-- Already existed empty in some 2.0.x DB, cannot be used anymore
    <nodeType name="artifactory:archive" isMixin="true">
        <propertyDefinition name="artifactory:archiveEntry" requiredType="String" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="true"/>
    </nodeType>
    -->

    <nodeType name="artifactory:timestamped" isMixin="true">
        <propertyDefinition name="artifactory:timestamp" requiredType="Date" autoCreated="false"
                            mandatory="true" onParentVersion="COPY" protected="false" multiple="false"/>
    </nodeType>

    <nodeType name="artifactory:stats" isMixin="true">
        <propertyDefinition name="artifactory:downloadCount" requiredType="Long" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
        <propertyDefinition name="artifactory:lastDownloaded" requiredType="Date" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
        <propertyDefinition name="artifactory:lastDownloadedBy" requiredType="String" autoCreated="false"
                            mandatory="false" onParentVersion="COPY" protected="false" multiple="false"/>
    </nodeType>

    <nodeType name="artifactory:logEntry" isMixin="false"
              hasOrderableChildNodes="false" primaryItemName="artifactory:timestamp">
        <supertypes>
            <supertype>artifactory:timestamped</supertype>
            <supertype>mix:lockable</supertype>
            <supertype>nt:unstructured</supertype>
        </supertypes>
    </nodeType>

    <!-- OCM -->
    <nodeType name="ocm:discriminator" isMixin="true">
        <supertypes>
            <supertype>nt:base</supertype>
        </supertypes>
        <propertyDefinition name="ocm:classname" requiredType="String" autoCreated="false"
                            mandatory="true" onParentVersion="COPY" protected="false" multiple="false"/>
    </nodeType>

</nodeTypes>
